---
title: "Task 3"
author: ""
date: "11/16/2018"
output: html_document
---

```{r}
library(MASS)
library(ISLR)
library(dplyr)
library(mosaic)
library(ggplot2)

Energy = read.csv("energydata_complete.csv")

```
```{r}
names(Energy)
```
install.packages("s20x")

##Five images of our data

####Comparison of temperatures

```{r}
ggplot(Energy) +
  geom_boxplot(aes(x=1, y=T1)) +
  geom_boxplot(aes(x=2, y=T2)) +
  geom_boxplot(aes(x=3, y=T3)) +
  geom_boxplot(aes(x=4, y=T4)) +
  geom_boxplot(aes(x=5, y=T5)) +
  geom_boxplot(aes(x=6, y=T6)) +
  geom_boxplot(aes(x=7, y=T7)) +
  geom_boxplot(aes(x=8, y=T8)) +
  geom_boxplot(aes(x=9, y=T9)) +
  geom_boxplot(aes(x=10, y=T_out)) +
  coord_flip() +
  annotate("text", x=1:10, y=35, label=c("Kitchen", "Living Room", "Laundry Room", "Office Room", "Bathroom", "North side", "Ironing Room", "Teenager Room", "Parents Room", "Outside"), size=4) +
   ylim(-8,38)
```

There are two measurements of temperature that are outside the house (North side and Outside) and eight that are inside. The outside ones have a much larger range while the inside ones stay more consistant over the seasons and over the day. From this we can see that colinearity between variables inside the house might be likely but less so when comparing inside and outside the house.

####Comparison of humidity

```{r}
ggplot(Energy) +
  geom_boxplot(aes(x=1, y=RH_1)) +
  geom_boxplot(aes(x=2, y=RH_2)) +
  geom_boxplot(aes(x=3, y=RH_3)) +
  geom_boxplot(aes(x=4, y=RH_4)) +
  geom_boxplot(aes(x=5, y=RH_5)) +
  geom_boxplot(aes(x=6, y=RH_6)) +
  geom_boxplot(aes(x=7, y=RH_7)) +
  geom_boxplot(aes(x=8, y=RH_8)) +
  geom_boxplot(aes(x=9, y=RH_9)) +
  geom_boxplot(aes(x=10, y=RH_out)) +
  coord_flip() +
  annotate("text", x=1:10, y=110, label=c("Kitchen", "Living Room", "Laundry Room", "Office Room", "Bathroom", "North side", "Ironing Room", "Teenager Room", "Parents Room", "Outside"), size=4) +
   ylim(-5, 120)
```

The graph of the humidity is a lot more interesting than the temperature graph because the two outside temperatures are no longer similar. The "north side"" humidity which is measured just outside the house is much lower than the "outside humidity" which is taken from weather station data nearby. There also is a huge range of humidity in the bathroom, which presumably comes from when people in the house shower.

####How correlated is temperature and humidity?

```{r}
#Indoor room
ggplot(Energy) +
  geom_point(aes(x=T1, y=RH_1)) +
  geom_smooth(aes(x=T1, y=RH_1))

#Outdoor room
ggplot(Energy) +
  geom_point(aes(x=T6, y=RH_6)) +
  geom_smooth(aes(x=T6, y=RH_6))
```

Humidity does not seem to be correlated with temperature at all either inside or outside the house which is very facinating. My assumption was that since it is more humid on hot days, they will have a positive relationship, which is not reflected in the data at all.

####Impact of temperature on appliance energy use

Instead of looking at just one room, I am going to create a new variable that has the average temperature inside and another for the average temperature outside.

```{r}
Energy2 <- Energy %>%
  mutate(avgInTemp = (T1+T2+T3+T4+T5+T7+T8+T9)/8) %>%
  mutate(avgOutTemp = (T6 + T_out)/2)
```

Now we can use these new variables to check the impact on appliance energy use.

```{r}
ggplot(Energy2) +
  geom_point(aes(x=avgInTemp, y=Appliances), color="lightblue") +
  geom_point(aes(x=avgOutTemp, y=Appliances), color="pink") +
  geom_smooth(aes(x=avgInTemp, y=Appliances), color="darkblue") +
  geom_smooth(aes(x=avgOutTemp, y=Appliances), color="red")

```

There seems to be a slight increase in appliance energy usage as temperature increases but the difference is not clear enough to guess whether it may be statistically signficant before running the model.

```{r}
#Create numerical summaries for at least 4 variables in your dataset
myvars <- c("Appliances", "lights" ,"T1" ,"RH_1" )
newdata <- Energy[myvars]
library(psych)               
describe(newdata)
```

```{r}
#model_aov <- aov(Appliances ~ date + lights + T1 + RH_1 + T2 + RH_2 + T3 + RH_3 + T4 + RH_4 + T5 + RH_5 + T6 + RH_6 + T7 + RH_7 + T8 + RH_8 + T9 + RH_9 + T_out + Press_mm_hg + RH_out + Windspeed + Visibility + Tdewpoint + rv1 + rv2, Energy)
Energy3 <- Energy %>%
  select(-date)

model_aov <- aov(Appliances ~. , Energy3)
anova(model_aov)
```

Variables that have an impact:
lights, T1, RH_1, T2, RH_2, T3, T4, RH_4, T5, T6, RH_7, T8, RH_8, T9, T_out, Windspeed, Tdewpoint